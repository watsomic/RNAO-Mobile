(function(){var undefined,xui,window=this,string=new String("string"),document=window.document,simpleExpr=/^#?([\w-]+)$/,idExpr=/^#/,tagExpr=/<([\w:]+)/,slice=function(e){return[].slice.call(e,0)};try{var a=slice(document.documentElement.childNodes)[0].nodeType}catch(e){slice=function(e){var ret=[];for(var i=0;e[i];i++){ret.push(e[i])}return ret}}window.x$=window.xui=xui=function(q,context){return new xui.fn.find(q,context)};if(![].forEach){Array.prototype.forEach=function(fn){var len=this.length||0,i=0,that=arguments[1];if(typeof fn=="function"){for(;i<len;i++){fn.call(that,this[i],i,this)}}}}function removex(array,from,to){var rest=array.slice((to||from)+1||array.length);array.length=from<0?array.length+from:from;return array.push.apply(array,rest)}xui.fn=xui.prototype={extend:function(o){for(var i in o){xui.fn[i]=o[i]}},find:function(q,context){var ele=[],tempNode;if(!q){return this}else{if(context==undefined&&this.length){ele=this.each(function(el){ele=ele.concat(slice(xui(q,el)))}).reduce(ele)}else{context=context||document;if(typeof q==string){if(simpleExpr.test(q)&&context.getElementById&&context.getElementsByTagName){ele=idExpr.test(q)?[context.getElementById(q.substr(1))]:context.getElementsByTagName(q);if(ele[0]==null){ele=[]}}else{if(tagExpr.test(q)){tempNode=document.createElement("i");tempNode.innerHTML=q;slice(tempNode.childNodes).forEach(function(el){ele.push(el)})}else{if(window.Sizzle!==undefined){ele=Sizzle(q,context)}else{ele=context.querySelectorAll(q)}}}ele=slice(ele)}else{if(q instanceof Array){ele=q}else{if(q.toString()=="[object NodeList]"){ele=slice(q)}else{if(q.nodeName||q===window){ele=[q]}}}}}}return this.set(ele)},set:function(elements){var ret=xui();ret.cache=slice(this.length?this:[]);ret.length=0;[].push.apply(ret,elements);return ret},reduce:function(elements,b){var a=[],elements=elements||slice(this);elements.forEach(function(el){if(a.indexOf(el,0,b)<0){a.push(el)}});return a},has:function(q){var list=xui(q);return this.filter(function(){var that=this;var found=null;list.each(function(el){found=(found||el==that)});return found})},filter:function(fn){var elements=[];return this.each(function(el,i){if(fn.call(el,i)){elements.push(el)}}).set(elements)},not:function(q){var list=slice(this);return this.filter(function(i){var found;xui(q).each(function(el){return found=list[i]!=el});return found})},each:function(fn){for(var i=0,len=this.length;i<len;++i){if(fn.call(this[i],this[i],i,this)===false){break}}return this}};xui.fn.find.prototype=xui.fn;xui.extend=xui.fn.extend;xui.extend({html:function(location,html){clean(this);if(arguments.length==0){return this[0].innerHTML}if(arguments.length==1&&arguments[0]!="remove"){html=location;location="inner"}if(html&&html.each!==undefined){var that=this;html.each(function(el){that.html(location,el)});return this}return this.each(function(el){var parent,list,len,i=0;if(location=="inner"){if(typeof html==string||typeof html=="number"){el.innerHTML=html;list=el.getElementsByTagName("SCRIPT");len=list.length;for(;i<len;i++){eval(list[i].text)}}else{el.innerHTML="";el.appendChild(html)}}else{if(location=="outer"){el.parentNode.replaceChild(wrapHelper(html,el),el)}else{if(location=="top"){el.insertBefore(wrapHelper(html,el),el.firstChild)}else{if(location=="bottom"){el.insertBefore(wrapHelper(html,el),null)}else{if(location=="remove"){el.parentNode.removeChild(el)}else{if(location=="before"){el.parentNode.insertBefore(wrapHelper(html,el.parentNode),el)}else{if(location=="after"){el.parentNode.insertBefore(wrapHelper(html,el.parentNode),el.nextSibling)}}}}}}}})},attr:function(attribute,val){if(arguments.length==2){return this.each(function(el){(attribute=="checked"&&(val==""||val==false||typeof val=="undefined"))?el.removeAttribute(attribute):el.setAttribute(attribute,val)})}else{var attrs=[];this.each(function(el){var val=el.getAttribute(attribute);if(val!=null){attrs.push(val)}});return attrs}}});"inner outer top bottom remove before after".split(" ").forEach(function(method){xui.fn[method]=function(where){return function(html){return this.html(where,html)}}(method)});function getTag(el){return(el.firstChild===null)?{UL:"LI",DL:"DT",TR:"TD"}[el.tagName]||el.tagName:el.firstChild.tagName}function wrapHelper(html,el){return(typeof html==string)?wrap(html,getTag(el)):html}function wrap(xhtml,tag){var attributes={},re=/^<([A-Z][A-Z0-9]*)([^>]*)>([\s\S]*)<\/\1>/i,element,x,a,i=0,attr,node,attrList,result;if(re.test(xhtml)){result=re.exec(xhtml);tag=result[1];if(result[2]!==""){attrList=result[2].split(/([A-Z]*\s*=\s*['|"][A-Z0-9:;#\s]*['|"])/i);for(;i<attrList.length;i++){attr=attrList[i].replace(/^\s*|\s*$/g,"");if(attr!==""&&attr!==" "){node=attr.split("=");attributes[node[0]]=node[1].replace(/(["']?)/g,"")}}}xhtml=result[3]}element=document.createElement(tag);for(x in attributes){a=document.createAttribute(x);a.nodeValue=attributes[x];element.setAttributeNode(a)}element.innerHTML=xhtml;return element}function clean(collection){var ns=/\S/;collection.each(function(el){var d=el,n=d.firstChild,ni=-1,nx;while(n){nx=n.nextSibling;if(n.nodeType==3&&!ns.test(n.nodeValue)){d.removeChild(n)}else{n.nodeIndex=++ni}n=nx}})}xui.events={};var cache={};xui.extend({on:function(type,fn,details){return this.each(function(el){if(xui.events[type]){var id=_getEventID(el),responders=_getRespondersForEvent(id,type);details=details||{};details.handler=function(event,data){xui.fn.fire.call(xui(this),type,data)};if(!responders.length){xui.events[type].call(el,details)}}el.addEventListener(type,_createResponder(el,type,fn),false)})},un:function(type,fn){return this.each(function(el){var id=_getEventID(el),responders=_getRespondersForEvent(id,type),i=responders.length;while(i--){if(fn===undefined||fn.guid===responders[i].guid){el.removeEventListener(type,responders[i],false);removex(cache[id][type],i,1)}}if(cache[id][type].length===0){delete cache[id][type]}for(var t in cache[id]){return}delete cache[id]})},fire:function(type,data){return this.each(function(el){if(el==document&&!el.dispatchEvent){el=document.documentElement}var event=document.createEvent("HTMLEvents");event.initEvent(type,true,true);event.data=data||{};event.eventName=type;el.dispatchEvent(event)})}});"click load submit touchstart touchmove touchend touchcancel gesturestart gesturechange gestureend orientationchange".split(" ").forEach(function(event){xui.fn[event]=function(action){return function(fn){return fn?this.on(action,fn):this.fire(action)}}(event)});xui(window).on("load",function(){if(!("onorientationchange" in document.body)){(function(){var w=window.innerWidth,h=window.innerHeight;xui(window).on("resize",function(){var portraitSwitch=(window.innerWidth<w&&window.innerHeight>h)&&(window.innerWidth<window.innerHeight),landscapeSwitch=(window.innerWidth>w&&window.innerHeight<h)&&(window.innerWidth>window.innerHeight);if(portraitSwitch||landscapeSwitch){window.orientation=portraitSwitch?0:90;$("body").fire("orientationchange");w=window.innerWidth;h=window.innerHeight}})})()}});xui.touch=(function(){try{return !!(document.createEvent("TouchEvent").initTouchEvent)}catch(e){return false}})();function _getEventID(element){if(element._xuiEventID){return element._xuiEventID}return element._xuiEventID=++_getEventID.id}_getEventID.id=1;function _getRespondersForEvent(id,eventName){var c=cache[id]=cache[id]||{};return c[eventName]=c[eventName]||[]}function _createResponder(element,eventName,handler){var id=_getEventID(element),r=_getRespondersForEvent(id,eventName);var responder=function(event){if(handler.call(element,event)===false){event.preventDefault();event.stopPropagation()}};responder.guid=handler.guid=handler.guid||++_getEventID.id;responder.handler=handler;r.push(responder);return responder}xui.extend({tween:function(props,callback){var emileOpts=function(o){var options={};"duration after easing".split(" ").forEach(function(p){if(props[p]){options[p]=props[p];delete props[p]}});return options};var serialize=function(props){var serialisedProps=[],key;if(typeof props!=string){for(key in props){serialisedProps.push(key+":"+props[key])}serialisedProps=serialisedProps.join(";")}else{serialisedProps=props}return serialisedProps};if(props instanceof Array){props.forEach(function(a){})}var opts=emileOpts(props);var prop=serialize(props);return this.each(function(e){emile(e,prop,opts,callback)})}});function hasClass(el,className){return getClassRegEx(className).test(el.className)}var rtrim=/^(\s|\u00A0)+|(\s|\u00A0)+$/g;function trim(text){return(text||"").replace(rtrim,"")}xui.extend({setStyle:function(prop,val){prop=prop.replace(/\-[a-z]/g,function(m){return m[1].toUpperCase()});return this.each(function(el){el.style[prop]=val})},getStyle:function(prop,callback){var s=function(el,p){return document.defaultView.getComputedStyle(el,"").getPropertyValue(p.replace(/[A-Z]/g,function(m){return"-"+m.toLowerCase()}))};return(callback===undefined)?s(this[0],prop):this.each(function(el){callback(s(el,prop))})},addClass:function(className){return this.each(function(el){if(hasClass(el,className)===false){el.className=trim(el.className+" "+className)}})},hasClass:function(className,callback){var self=this;return this.length&&(function(){var hasIt=false;self.each(function(el){if(hasClass(el,className)){hasIt=true;if(callback){callback(el)}}});return hasIt})()},removeClass:function(className){if(className===undefined){this.each(function(el){el.className=""})}else{var re=getClassRegEx(className);this.each(function(el){el.className=trim(el.className.replace(re,"$1"))})}return this},css:function(o){for(var prop in o){this.setStyle(prop,o[prop])}return this}});var reClassNameCache={},getClassRegEx=function(className){var re=reClassNameCache[className];if(!re){re=new RegExp("(^|\\s+)"+className+"(?:\\s+|$)");reClassNameCache[className]=re}return re};xui.extend({xhr:function(location,url,options){if(!/^(inner|outer|top|bottom|before|after)$/.test(location)){options=url;url=location;location="inner"}var o=options?options:{};if(typeof options=="function"){o={};o.callback=options}var that=this,req=new XMLHttpRequest(),method=o.method||"get",async=o.async||false,params=o.data||null,i=0;req.queryString=params;req.open(method,url,async);if(o.headers){for(;i<o.headers.length;i++){req.setRequestHeader(o.headers[i].name,o.headers[i].value)}}req.handleResp=(o.callback!=null)?o.callback:function(){that.html(location,this.responseText)};req.handleError=(o.error&&typeof o.error=="function")?o.error:function(){};function hdl(){if(req.readyState==4){delete (that.xmlHttpRequest);if(req.status===0||req.status==200){req.handleResp()}if((/^[45]/).test(req.status)){req.handleError()}}}if(async){req.onreadystatechange=hdl;this.xmlHttpRequest=req}req.send(params);if(!async){hdl()}return this}});(function(emile,container){var parseEl=document.createElement("div"),props=("backgroundColor borderBottomColor borderBottomWidth borderLeftColor borderLeftWidth borderRightColor borderRightWidth borderSpacing borderTopColor borderTopWidth bottom color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex").split(" ");function interpolate(source,target,pos){return(source+(target-source)*pos).toFixed(3)}function s(str,p,c){return str.substr(p,c||1)}function color(source,target,pos){var i=2,j,c,tmp,v=[],r=[];while(j=3,c=arguments[i-1],i--){if(s(c,0)=="r"){c=c.match(/\d+/g);while(j--){v.push(~~c[j])}}else{if(c.length==4){c="#"+s(c,1)+s(c,1)+s(c,2)+s(c,2)+s(c,3)+s(c,3)}while(j--){v.push(parseInt(s(c,1+j*2,2),16))}}}while(j--){tmp=~~(v[j+3]+(v[j]-v[j+3])*pos);r.push(tmp<0?0:tmp>255?255:tmp)}return"rgb("+r.join(",")+")"}function parse(prop){var p=parseFloat(prop),q=prop.replace(/^[\-\d\.]+/,"");return isNaN(p)?{v:q,f:color,u:""}:{v:p,f:interpolate,u:q}}function normalize(style){var css,rules={},i=props.length,v;parseEl.innerHTML='<div style="'+style+'"></div>';css=parseEl.childNodes[0].style;while(i--){if(v=css[props[i]]){rules[props[i]]=parse(v)}}return rules}container[emile]=function(el,style,opts,after){el=typeof el=="string"?document.getElementById(el):el;opts=opts||{};var target=normalize(style),comp=el.currentStyle?el.currentStyle:getComputedStyle(el,null),prop,current={},start=+new Date,dur=opts.duration||200,finish=start+dur,interval,easing=opts.easing||function(pos){return(-Math.cos(pos*Math.PI)/2)+0.5};for(prop in target){current[prop]=parse(comp[prop])}interval=setInterval(function(){var time=+new Date,pos=time>finish?1:(time-start)/dur;for(prop in target){el.style[prop]=target[prop].f(current[prop].v,target[prop].v,easing(pos))+target[prop].u}if(time>finish){clearInterval(interval);opts.after&&opts.after();after&&setTimeout(after,1)}},10)}})("emile",this);
/*
 * Sizzle CSS Selector Engine - v1.0
 *  Copyright 2009, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==1&&context.nodeType!==9){return[]}if(!selector||typeof selector!=="string"){return results}var parts=[],m,set,checkSet,extra,prune=true,contextXML=Sizzle.isXML(context),soFar=selector,ret,cur,pop,i;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector)){if(parts.length===2&&Expr.relative[parts[0]]){set=posProcess(parts[0]+parts[1],context)}else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector]){selector+=parts.shift()}set=posProcess(selector,set)}}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0){checkSet=makeArray(set)}else{prune=false}while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur]){cur=""}else{pop=parts.pop()}if(pop==null){pop=context}Expr.relative[cur](checkSet,pop,contextXML)}}else{checkSet=parts=[]}}if(!checkSet){checkSet=set}if(!checkSet){Sizzle.error(cur||selector)}if(toString.call(checkSet)==="[object Array]"){if(!prune){results.push.apply(results,checkSet)}else{if(context&&context.nodeType===1){for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i]))){results.push(set[i])}}}else{for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1){results.push(set[i])}}}}}else{makeArray(checkSet,results)}if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(var i=1;i<results.length;i++){if(results[i]===results[i-1]){results.splice(i--,1)}}}}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.find=function(expr,context,isXML){var set;if(!expr){return[]}for(var i=0,l=Expr.order.length;i<l;i++){var type=Expr.order[i],match;if((match=Expr.leftMatch[type].exec(expr))){var left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(/\\/g,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set){set=context.getElementsByTagName("*")}return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var old=expr,result=[],curLoop=set,match,anyFound,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);while(expr&&set.length){for(var type in Expr.filter){if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){var filter=Expr.filter[type],found,item,left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\"){continue}if(curLoop===result){result=[]}if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match){anyFound=found=true}else{if(match===true){continue}}}if(match){for(var i=0;(item=curLoop[i])!=null;i++){if(item){found=filter(item,match,i,curLoop);var pass=not^!!found;if(inplace&&found!=null){if(pass){anyFound=true}else{curLoop[i]=false}}else{if(pass){result.push(item);anyFound=true}}}}}if(found!==undefined){if(!inplace){curLoop=result}expr=expr.replace(Expr.match[type],"");if(!anyFound){return[]}break}}}if(expr===old){if(anyFound==null){Sizzle.error(expr)}else{break}}old=expr}return curLoop};Sizzle.error=function(msg){throw"Syntax error, unrecognized expression: "+msg};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!/\W/.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag){part=part.toLowerCase()}for(var i=0,l=checkSet.length,elem;i<l;i++){if((elem=checkSet[i])){while((elem=elem.previousSibling)&&elem.nodeType!==1){}checkSet[i]=isPartStrNotTag||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}}if(isPartStrNotTag){Sizzle.filter(part,checkSet,true)}},">":function(checkSet,part){var isPartStr=typeof part==="string",elem,i=0,l=checkSet.length;if(isPartStr&&!/\W/.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem){checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part}}if(isPartStr){Sizzle.filter(part,checkSet,true)}}},"":function(checkSet,part,isXML){var doneName=done++,checkFn=dirCheck,nodeCheck;if(typeof part==="string"&&!/\W/.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var doneName=done++,checkFn=dirCheck,nodeCheck;if(typeof part==="string"&&!/\W/.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++){if(results[i].getAttribute("name")===match[1]){ret.push(results[i])}}return ret.length===0?null:ret}},TAG:function(match,context){return context.getElementsByTagName(match[1])}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(/\\/g,"")+" ";if(isXML){return match}for(var i=0,elem;(elem=curLoop[i])!=null;i++){if(elem){if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n]/g," ").indexOf(match)>=0)){if(!inplace){result.push(elem)}}else{if(inplace){curLoop[i]=false}}}}return false},ID:function(match){return match[1].replace(/\\/g,"")},TAG:function(match,curLoop){return match[1].toLowerCase()},CHILD:function(match){if(match[1]==="nth"){var test=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=(test[1]+(test[2]||1))-0;match[3]=test[3]-0}match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1].replace(/\\/g,"");if(!isXML&&Expr.attrMap[name]){match[1]=Expr.attrMap[name]}if(match[2]==="~="){match[4]=" "+match[4]+" "}return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not"){if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3])){match[3]=Sizzle(match[3],null,null,curLoop)}else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace){result.push.apply(result,ret)}return false}}else{if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0])){return true}}return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){elem.parentNode.selectedIndex;return elem.selected===true},parent:function(elem){return !!elem.firstChild},empty:function(elem){return !elem.firstChild},has:function(elem,i,match){return !!Sizzle(match[3],elem).length},header:function(elem){return(/h\d/i).test(elem.nodeName)},text:function(elem){return"text"===elem.type},radio:function(elem){return"radio"===elem.type},checkbox:function(elem){return"checkbox"===elem.type},file:function(elem){return"file"===elem.type},password:function(elem){return"password"===elem.type},submit:function(elem){return"submit"===elem.type},image:function(elem){return"image"===elem.type},reset:function(elem){return"reset"===elem.type},button:function(elem){return"button"===elem.type||elem.nodeName.toLowerCase()==="button"},input:function(elem){return(/input|select|textarea|button/i).test(elem.nodeName)}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter){return filter(elem,i,match,array)}else{if(name==="contains"){return(elem.textContent||elem.innerText||Sizzle.getText([elem])||"").indexOf(match[3])>=0}else{if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++){if(not[j]===elem){return false}}return true}else{Sizzle.error("Syntax error, unrecognized expression: "+name)}}}},CHILD:function(elem,match){var type=match[1],node=elem;switch(type){case"only":case"first":while((node=node.previousSibling)){if(node.nodeType===1){return false}}if(type==="first"){return true}node=elem;case"last":while((node=node.nextSibling)){if(node.nodeType===1){return false}}return true;case"nth":var first=match[2],last=match[3];if(first===1&&last===0){return true}var doneName=match[0],parent=elem.parentNode;if(parent&&(parent.sizcache!==doneName||!elem.nodeIndex)){var count=0;for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.nodeIndex=++count}}parent.sizcache=doneName}var diff=elem.nodeIndex-last;if(first===0){return diff===0}else{return(diff%first===0&&diff/first>=0)}}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return(match==="*"&&elem.nodeType===1)||elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1},ATTR:function(elem,match){var name=match[1],result=Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter){return filter(elem,i,match,array)}}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+(/(?![^\[]*\])(?![^\(]*\))/.source));Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,fescape))}var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var ret=results||[],i=0;if(toString.call(array)==="[object Array]"){Array.prototype.push.apply(ret,array)}else{if(typeof array.length==="number"){for(var l=array.length;i<l;i++){ret.push(array[i])}}else{for(;array[i];i++){ret.push(array[i])}}}return ret}}var sortOrder;if(document.documentElement.compareDocumentPosition){sortOrder=function(a,b){if(!a.compareDocumentPosition||!b.compareDocumentPosition){if(a==b){hasDuplicate=true}return a.compareDocumentPosition?-1:1}var ret=a.compareDocumentPosition(b)&4?-1:a===b?0:1;if(ret===0){hasDuplicate=true}return ret}}else{if("sourceIndex" in document.documentElement){sortOrder=function(a,b){if(!a.sourceIndex||!b.sourceIndex){if(a==b){hasDuplicate=true}return a.sourceIndex?-1:1}var ret=a.sourceIndex-b.sourceIndex;if(ret===0){hasDuplicate=true}return ret}}else{if(document.createRange){sortOrder=function(a,b){if(!a.ownerDocument||!b.ownerDocument){if(a==b){hasDuplicate=true}return a.ownerDocument?-1:1}var aRange=a.ownerDocument.createRange(),bRange=b.ownerDocument.createRange();aRange.setStart(a,0);aRange.setEnd(a,0);bRange.setStart(b,0);bRange.setEnd(b,0);var ret=aRange.compareBoundaryPoints(Range.START_TO_END,bRange);if(ret===0){hasDuplicate=true}return ret}}}}Sizzle.getText=function(elems){var ret="",elem;for(var i=0;elems[i];i++){elem=elems[i];if(elem.nodeType===3||elem.nodeType===4){ret+=elem.nodeValue}else{if(elem.nodeType!==8){ret+=Sizzle.getText(elem.childNodes)}}}return ret};(function(){var form=document.createElement("div"),id="script"+(new Date()).getTime();form.innerHTML="<a name='"+id+"'/>";var root=document.documentElement;root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0){Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++){if(results[i].nodeType===1){tmp.push(results[i])}}results=tmp}return results}}div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)}}div=null})();if(document.querySelectorAll){(function(){var oldSizzle=Sizzle,div=document.createElement("div");div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){return}Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&context.nodeType===9&&!Sizzle.isXML(context)){try{return makeArray(context.querySelectorAll(query),extra)}catch(e){}}return oldSizzle(query,context,extra,seed)};for(var prop in oldSizzle){Sizzle[prop]=oldSizzle[prop]}div=null})()}(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0){return}div.lastChild.className="e";if(div.getElementsByClassName("e").length===1){return}Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML){return context.getElementsByClassName(match[1])}};div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){elem=elem[dir];var match=false;while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1&&!isXML){elem.sizcache=doneName;elem.sizset=i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){elem=elem[dir];var match=false;while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem.sizcache=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else{if(Sizzle.filter(cur,[elem]).length>0){match=elem;break}}}elem=elem[dir]}checkSet[i]=match}}}Sizzle.contains=document.compareDocumentPosition?function(a,b){return !!(a.compareDocumentPosition(b)&16)}:function(a,b){return a!==b&&(a.contains?a.contains(b):true)};Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var posProcess=function(selector,context){var tmpSet=[],later="",match,root=context.nodeType?[context]:context;while((match=Expr.match.PSEUDO.exec(selector))){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++){Sizzle(selector,root[i],tmpSet)}return Sizzle.filter(later,tmpSet)};window.Sizzle=Sizzle})()})();var _anomFunkMap={};var _anomFunkMapNextId=0;function anomToNameFunk(a){var c="f"+_anomFunkMapNextId++;var b=function(){a.apply(this,arguments);_anomFunkMap[c]=null;delete _anomFunkMap[c]};_anomFunkMap[c]=b;return"_anomFunkMap."+c}function GetFunctionName(b){if(b){var a=b.toString().match(/^\s*function\s+([^\s\(]+)/);return a?a[1]:anomToNameFunk(b)}else{return null}}if(typeof(DeviceInfo)!="object"){DeviceInfo={}}PhoneGap={queue:{ready:true,commands:[],timer:null},_constructors:[]};PhoneGap.available=DeviceInfo.uuid!=undefined;PhoneGap.addConstructor=function(a){var b=document.readyState;if((b=="loaded"||b=="complete")&&DeviceInfo.uuid!=null){a()}else{PhoneGap._constructors.push(a)}};(function(){var a=setInterval(function(){var c=document.readyState;if((c=="loaded"||c=="complete")&&DeviceInfo.uuid!=null){clearInterval(a);while(PhoneGap._constructors.length>0){var b=PhoneGap._constructors.shift();try{b()}catch(d){if(typeof(debug.log)=="function"){debug.log("Failed to run constructor: "+debug.processMessage(d))}else{alert("Failed to run constructor: "+d.message)}}}var d=document.createEvent("Events");d.initEvent("deviceready");document.dispatchEvent(d)}},1)})();PhoneGap.exec=function(){PhoneGap.queue.commands.push(arguments);if(PhoneGap.queue.timer==null){PhoneGap.queue.timer=setInterval(PhoneGap.run_command,10)}};PhoneGap.run_command=function(){if(!PhoneGap.available||!PhoneGap.queue.ready){return}PhoneGap.queue.ready=false;var c=PhoneGap.queue.commands.shift();if(PhoneGap.queue.commands.length==0){clearInterval(PhoneGap.queue.timer);PhoneGap.queue.timer=null}var e=[];var f=null;for(var d=1;d<c.length;d++){var a=c[d];if(a==undefined||a==null){continue}if(typeof(a)=="object"){f=a}else{e.push(encodeURIComponent(a))}}var b="gap://"+c[0]+"/"+e.join("/");if(f!=null){b+="?"+encodeURIComponent(JSON.stringify(f))}document.location=b};PhoneGap.clone=function(c){if(!c){return c}if(c instanceof Array){var b=new Array();for(var a=0;a<c.length;++a){b.push(PhoneGap.clone(c[a]))}return b}if(c instanceof Function){return c}if(!(c instanceof Object)){return c}if(c instanceof Date){return c}b=new Object();for(a in c){if(!(a in b)||b[a]!=c[a]){b[a]=PhoneGap.clone(c[a])}}return b};function Acceleration(a,c,b){this.x=a;this.y=c;this.z=b;this.timestamp=new Date().getTime()}function AccelerationOptions(){this.timeout=10000}function Accelerometer(){this.lastAcceleration=new Acceleration(0,0,0)}Accelerometer.prototype.getCurrentAcceleration=function(a,b,c){if(typeof a=="function"){a(this.lastAcceleration)}};Accelerometer.prototype._onAccelUpdate=function(a,c,b){this.lastAcceleration=new Acceleration(a,c,b)};Accelerometer.prototype.watchAcceleration=function(a,c,d){var e=(d!=undefined&&d.frequency!=undefined)?d.frequency:10000;var b={desiredFrequency:e};PhoneGap.exec("Accelerometer.start",d);return setInterval(function(){navigator.accelerometer.getCurrentAcceleration(a,c,d)},e)};Accelerometer.prototype.clearWatch=function(a){PhoneGap.exec("Accelerometer.stop");clearInterval(a)};PhoneGap.addConstructor(function(){if(typeof navigator.accelerometer=="undefined"){navigator.accelerometer=new Accelerometer()}});function Camera(){}Camera.prototype.getPicture=function(a,b,c){PhoneGap.exec("Camera.getPicture",GetFunctionName(a),GetFunctionName(b),c)};Camera.prototype.PictureSourceType={PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2};Camera.DestinationType={DATA_URL:0,FILE_URI:1};Camera.prototype.DestinationType=Camera.DestinationType;PhoneGap.addConstructor(function(){if(typeof navigator.camera=="undefined"){navigator.camera=new Camera()}});var Contact=function(o,f,x,q,u,j,c,p,d,t,r,k,e,n,b,a,w,m,g,s,h,l,v){this.id=o||null;this.displayName=f||null;this.name=x||null;this.nickname=q||null;this.phoneNumbers=u||null;this.emails=j||null;this.addresses=c||null;this.ims=p||null;this.organizations=d||null;this.published=t||null;this.updated=r||null;this.birthday=k||null;this.anniversary=e||null;this.gender=n||null;this.note=b||null;this.preferredUsername=a||null;this.photos=w||null;this.tags=m||null;this.relationships=g||null;this.urls=s||null;this.accounts=h||null;this.utcOffset=l||null;this.connected=v||null};Contact.prototype.convertDatesOut=function(){var d=new Array("published","updated","birthday","anniversary");for(var b=0;b<d.length;b++){var c=this[d[b]];if(c){if(!c instanceof Date){try{c=new Date(c)}catch(a){c=null}}if(c instanceof Date){c=c.valueOf()}this[d[b]]=c}}};Contact.prototype.convertDatesIn=function(){var d=new Array("published","updated","birthday");for(var b=0;b<d.length;b++){var c=this[d[b]];if(c){try{this[d[b]]=new Date(parseFloat(c))}catch(a){console.log("exception creating date")}}}};Contact.prototype.remove=function(d,b){if(this.id==null){var c=new ContactError();c.code=ContactError.NOT_FOUND_ERROR;b(c)}navigator.service.contacts.resultsCallback=d;var a=(b==undefined||b==null)?null:GetFunctionName(b);PhoneGap.exec("Contacts.remove",GetFunctionName(d),a,{contact:this})};Contact.prototype.display=function(d,b,a){if(this.id==null){var c=new ContactError();c.code=ContactError.NOT_FOUND_ERROR;b(c)}PhoneGap.exec("Contacts.displayContact",this.id,GetFunctionName(d),GetFunctionName(b),a)};Contact.prototype.clone=function(){var a=PhoneGap.clone(this);a.id=null;if(a.phoneNumbers){for(i=0;i<a.phoneNumbers.length;i++){a.phoneNumbers[i].id=null}}if(a.emails){for(i=0;i<a.emails.length;i++){a.emails[i].id=null}}if(a.addresses){for(i=0;i<a.addresses.length;i++){a.addresses[i].id=null}}if(a.ims){for(i=0;i<a.ims.length;i++){a.ims[i].id=null}}if(a.organizations){for(i=0;i<a.organizations.length;i++){a.organizations[i].id=null}}if(a.tags){for(i=0;i<a.tags.length;i++){a.tags[i].id=null}}if(a.relationships){for(i=0;i<a.relationships.length;i++){a.relationships[i].id=null}}if(a.urls){for(i=0;i<a.urls.length;i++){a.urls[i].id=null}}return a};Contact.prototype.save=function(c,b){navigator.service.contacts.resultsCallback=c;var a=PhoneGap.clone(this);a.convertDatesOut();PhoneGap.exec("Contacts.save",GetFunctionName(c),GetFunctionName(b),{contact:a})};var ContactName=function(e,a,c,b,d,f){this.formatted=e!="undefined"?e:null;this.familyName=a!="undefined"?a:null;this.givenName=c!="undefined"?c:null;this.middleName=b!="undefined"?b:null;this.honorificPrefix=d!="undefined"?d:null;this.honorificSuffix=f!="undefined"?f:null};var ContactField=function(b,c,a,d){this.type=b!="undefined"?b:null;this.value=c!="undefined"?c:null;this.primary=a!="undefined"?a:null;this.id=d!="undefined"?d:null};var ContactAddress=function(c,b,a,e,d,f,g){this.formatted=c!="undefined"?c:null;this.streetAddress=b!="undefined"?b:null;this.locality=a!="undefined"?a:null;this.region=e!="undefined"?e:null;this.postalCode=d!="undefined"?d:null;this.country=f!="undefined"?f:null;this.id=g!="undefined"?g:null};var ContactOrganization=function(c,e,g,a,d,b,f){this.name=c!="undefined"?c:null;this.department=e!="undefined"?e:null;this.title=g!="undefined"?g:null;this.startDate=a!="undefined"?a:null;this.endDate=d!="undefined"?d:null;this.location=b!="undefined"?b:null;this.description=f!="undefined"?f:null};var ContactAccount=function(b,c,a){this.domain=b!="undefined"?b:null;this.username=c!="undefined"?c:null;this.userid=a!="undefined"?a:null};var Contacts=function(){this.inProgress=false;this.records=new Array();this.resultsCallback=null};Contacts.prototype.find=function(a,f,e,c){this.resultsCallback=f;var h=c||null;if(h!=null){var g=h.updatedSince;if(g!=""){if(!g instanceof Date){try{g=new Date(g)}catch(d){g=null}}if(g instanceof Date){h.updatedSince=g.valueOf()}}}var b=(e==undefined||e==null)?null:GetFunctionName(e);PhoneGap.exec("Contacts.search",GetFunctionName(f),b,{fields:a,findOptions:h})};Contacts.prototype._findCallback=function(b){var h=null;if(b){h=new Array();try{for(var a=0;a<b.length;a++){var g=b[a];var d=navigator.service.contacts.create(g);d.convertDatesIn();h.push(d)}}catch(f){console.log("Error parsing contacts")}}try{this.resultsCallback(h)}catch(f){console.log("Error in user's result callback: "+f)}};Contacts.prototype._contactCallback=function(c){var a=null;if(c){try{a=navigator.service.contacts.create(c);a.convertDatesIn()}catch(b){console.log("Error parsing contact")}}try{this.resultsCallback(a)}catch(b){console.log("Error in user's result callback: "+b)}};Contacts.prototype.newContactUI=function(a){PhoneGap.exec("Contacts.newContact",GetFunctionName(a))};Contacts.prototype.chooseContact=function(a,b){PhoneGap.exec("Contacts.chooseContact",GetFunctionName(a),b)};Contacts.prototype.create=function(b){var a=new Contact();for(i in b){if(a[i]!="undefined"){a[i]=b[i]}}return a};var ContactFindOptions=function(d,a,b,c){this.filter=d||"";this.multiple=a||true;this.limit=b||null;this.updatedSince=c||""};var ContactError=function(){this.code=null};ContactError.UNKNOWN_ERROR=0;ContactError.INVALID_ARGUMENT_ERROR=1;ContactError.NOT_FOUND_ERROR=2;ContactError.TIMEOUT_ERROR=3;ContactError.PENDING_OPERATION_ERROR=4;ContactError.IO_ERROR=5;ContactError.NOT_SUPPORTED_ERROR=6;ContactError.PERMISSION_DENIED_ERROR=20;PhoneGap.addConstructor(function(){if(typeof navigator.service=="undefined"){navigator.service=new Object()}if(typeof navigator.service.contacts=="undefined"){navigator.service.contacts=new Contacts()}});function DebugConsole(a){this.logLevel=DebugConsole.INFO_LEVEL;this.isDeprecated=a?true:false}DebugConsole.ALL_LEVEL=1;DebugConsole.INFO_LEVEL=1;DebugConsole.WARN_LEVEL=2;DebugConsole.ERROR_LEVEL=4;DebugConsole.NONE_LEVEL=8;DebugConsole.prototype.setLevel=function(a){this.logLevel=a};DebugConsole.prototype.processMessage=function(b){if(typeof(b)!="object"){return(this.isDeprecated?"WARNING: debug object is deprecated, please use console object \n"+b:b)}else{function a(d){return d.replace(/^/mg,"    ")}function c(g){var h="";for(var d in g){try{if(typeof(g[d])=="object"){h+=d+":\n"+a(c(g[d]))+"\n"}else{h+=d+" = "+a(String(g[d])).replace(/^    /,"")+"\n"}}catch(f){h+=d+" = EXCEPTION: "+f.message+"\n"}}return h}return((this.isDeprecated?"WARNING: debug object is deprecated, please use console object\n":"")+"Object:\n"+c(b))}};DebugConsole.prototype.log=function(a){if(PhoneGap.available&&this.logLevel<=DebugConsole.INFO_LEVEL){PhoneGap.exec("DebugConsole.log",this.processMessage(a),{logLevel:"INFO"})}else{console.log(a)}};DebugConsole.prototype.warn=function(a){if(PhoneGap.available&&this.logLevel<=DebugConsole.WARN_LEVEL){PhoneGap.exec("DebugConsole.log",this.processMessage(a),{logLevel:"WARN"})}else{console.error(a)}};DebugConsole.prototype.error=function(a){if(PhoneGap.available&&this.logLevel<=DebugConsole.ERROR_LEVEL){PhoneGap.exec("DebugConsole.log",this.processMessage(a),{logLevel:"ERROR"})}else{console.error(a)}};PhoneGap.addConstructor(function(){window.console=new DebugConsole();window.debug=new DebugConsole(true)});function Device(){this.platform=null;this.version=null;this.name=null;this.phonegap=null;this.uuid=null;try{this.platform=DeviceInfo.platform;this.version=DeviceInfo.version;this.name=DeviceInfo.name;this.phonegap=DeviceInfo.gap;this.uuid=DeviceInfo.uuid}catch(a){}this.available=PhoneGap.available=this.uuid!=null}PhoneGap.addConstructor(function(){navigator.device=window.device=new Device()});PhoneGap.addConstructor(function(){if(typeof navigator.fileMgr=="undefined"){navigator.fileMgr=new FileMgr()}});FileError={NOT_IMPLEMENTED:-1,NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};File._createEvent=function(b,c){var a={type:b};a.target=c;return a};function FileMgr(){this.getFileBasePaths();this.getFreeDiskSpace()}FileMgr.seperator="/";FileMgr.prototype={fileWriters:{},fileReaders:{},docsFolderPath:"./../Documents/",libFolderPath:"./../Library/",tempFolderPath:"./../tmp/",freeDiskSpace:-1,_setPaths:function(c,a,b){this.docsFolderPath=c;this.tempFolderPath=a;this.libFolderPath=b},_setFreeDiskSpace:function(a){this.freeDiskSpace=a},addFileWriter:function(a,b){this.fileWriters[a]=b;return b},removeFileWriter:function(a){this.fileWriters[a]=null},addFileReader:function(b,a){this.fileReaders[b]=a;return a},removeFileReader:function(a){this.fileReaders[a]=null},reader_onloadstart:function(c,a){this.fileReaders[c].result=unescape(a);var b=File._createEvent("loadstart",this.fileReaders[c]);this.fileReaders[c].onloadstart(b)},reader_onprogress:function(c,a){this.fileReaders[c].result=unescape(a);var b=File._createEvent("progress",this.fileReaders[c]);this.fileReaders[c].onprogress(b)},reader_onload:function(c,a){this.fileReaders[c].result=unescape(a);var b=File._createEvent("load",this.fileReaders[c]);this.fileReaders[c].onload(b)},reader_onerror:function(b,c){this.fileReaders[b].result=c;this.fileReaders[b].result=unescape(result);var a=File._createEvent("error",this.fileReaders[b]);this.fileReaders[b].onerror(a)},reader_onloadend:function(c,a){this.fileReaders[c].result=unescape(a);var b=File._createEvent("loadend",this.fileReaders[c]);this.fileReaders[c].onloadend(b)},writer_onerror:function(a,b){this.fileWriters[a].error=b;this.fileWriters[a].onerror(b)},writer_oncomplete:function(c,a){var d=this.fileWriters[c];d.length=a;d.position=a;var b=File._createEvent("writeend",d);d.onwriteend(b);b.type="complete";d.oncomplete(b)},getRootPaths:function(){return[this.docsFolderPath,this.libFolderPath,this.tempFolderPath]},getFileBasePaths:function(){PhoneGap.exec("File.getFileBasePaths")},testFileExists:function(c,b,a){this.successCallback=function(d){b(d)};this.errorCallback=function(d){a(d)};PhoneGap.exec("File.testFileExists",c)},testDirectoryExists:function(b,c,a){this.successCallback=function(d){c(d)};this.errorCallback=function(d){a(d)};PhoneGap.exec("File.testDirectoryExists",b)},createDirectory:function(c,a,b){this.successCallback=a;this.errorCallback=b;PhoneGap.exec("File.createDirectory",c)},deleteDirectory:function(c,a,b){this.successCallback=a;this.errorCallback=b;PhoneGap.exec("File.deleteDirectory",c)},deleteFile:function(c,a,b){this.successCallback=a;this.errorCallback=b;PhoneGap.exec("File.deleteFile",c)},getFreeDiskSpace:function(a,b){if(this.freeDiskSpace>0){a(this.freeDiskSpace);return this.freeDiskSpace}else{this.successCallback=a;this.errorCallback=b;PhoneGap.exec("File.getFreeDiskSpace")}}};function FileReader(a){this.fileName=a}FileReader.EMPTY=0;FileReader.LOADING=1;FileReader.DONE=2;FileReader.prototype={fileName:null,result:null,onloadstart:null,onprogress:null,onload:null,onerror:null,onloadend:null,abort:function(){},readAsBinaryString:function(a){},readAsDataURL:function(a){},readAsArrayBuffer:function(a){},readAsText:function(a){if(this.fileName&&this.fileName.length>0){navigator.fileMgr.removeFileReader(this.fileName,this)}this.fileName=a;navigator.fileMgr.addFileReader(this.fileName,this);PhoneGap.exec("File.readFile",this.fileName)}};function FileWriter(a){if(navigator.fileMgr.fileWriters[a]!=null){return navigator.fileMgr.fileWriters[a]}else{this.fileName=a}}FileWriter.INIT=0;FileWriter.WRITING=1;FileWriter.DONE=2;FileWriter.prototype={fileName:"",result:null,readyState:0,onerror:null,oncomplete:null,onwritestart:null,onprogress:null,onload:null,onabort:null,onerror:null,onwriteend:null,length:0,position:0,error:null,write:function(a){return this.writeAsText(this.fileName,a)},truncate:function(a){if(this.readyState==FileWriter.WRITING){throw FileError.INVALID_STATE_ERR}this.readyState=FileWriter.WRITING;if(this.fileName&&this.fileName.length>0){navigator.fileMgr.removeFileWriter(this.fileName)}navigator.fileMgr.addFileWriter(this.fileName,this);this.readyState=0;this.result=null;PhoneGap.exec("File.truncateFile",this.fileName,a)},seek:function(a){if(this.readyState===FileWriter.WRITING){throw FileError.INVALID_STATE_ERR}if(!a){return}if(a<0){this.position=Math.max(a+this.length,0)}else{if(a>this.length){this.position=this.length}else{this.position=a}}},abort:function(){if(this.readyState!=FileWriter.WRITING){throw FileError.INVALID_STATE_ERR}var b=new FileError();b.code=FileError.ABORT_ERR;this.error=b;if(typeof this.onerror=="function"){var a=File._createEvent("error",this);this.onerror(a)}if(typeof this.onabort=="function"){var a=File._createEvent("abort",this);this.onabort(a)}this.readyState=FileWriter.DONE;if(typeof this.onloadend=="function"){var a=File._createEvent("writeend",this);this.onloadend(a)}},writeAsText:function(b,a){if(this.readyState==FileWriter.WRITING){throw FileError.INVALID_STATE_ERR}this.readyState=FileWriter.WRITING;if(this.fileName&&this.fileName.length>0){navigator.fileMgr.removeFileWriter(this.fileName)}this.fileName=b;navigator.fileMgr.addFileWriter(this.fileName,this);this.readyState=0;this.result=null;PhoneGap.exec("File.write",this.fileName,a,this.position)}};function PositionError(){this.code=0;this.message=""}PositionError.PERMISSION_DENIED=1;PositionError.POSITION_UNAVAILABLE=2;PositionError.TIMEOUT=3;function Geolocation(){this.lastPosition=null;this.lastError=null}Geolocation.prototype.getCurrentPosition=function(d,g,k){var h=0;if(this.lastError!=null){if(typeof(g)=="function"){g.call(null,this.lastError)}this.stop();return}this.start(k);var j=30000;var c=2000;if(k&&k.interval){c=k.interval}if(typeof(d)!="function"){d=function(){}}if(typeof(g)!="function"){g=function(){}}var e=this;var f=0;var b;var a=function(){f+=c;if(e.lastPosition!=null&&e.lastPosition.timestamp>h){clearInterval(b);d(e.lastPosition)}else{if(f>j){clearInterval(b);g("Error Timeout")}else{if(e.lastError!=null){clearInterval(b);g(e.lastError)}}}};b=setInterval(a,c)};Geolocation.prototype.watchPosition=function(a,b,c){this.getCurrentPosition(a,b,c);var e=(c&&c.frequency)?c.frequency:10000;var d=this;return setInterval(function(){d.getCurrentPosition(a,b,c)},e)};Geolocation.prototype.clearWatch=function(a){clearInterval(a)};Geolocation.prototype.setLocation=function(a){this.lastError=null;this.lastPosition=a};Geolocation.prototype.setError=function(a){this.lastError=a};Geolocation.prototype.start=function(a){PhoneGap.exec("Location.startLocation",a)};Geolocation.prototype.stop=function(){PhoneGap.exec("Location.stopLocation")};function __proxyObj(e,c,d){var a=function(h,f,g){h[g]=function(){return f[g].apply(f,arguments)}};for(var b in d){a(e,c,d[b])}}PhoneGap.addConstructor(function(){if(typeof navigator._geo=="undefined"){navigator._geo=new Geolocation();__proxyObj(navigator.geolocation,navigator._geo,["setLocation","getCurrentPosition","watchPosition","clearWatch","setError","start","stop"])}});function Compass(){this.lastHeading=null;this.lastError=null;this.callbacks={onHeadingChanged:[],onError:[]}}Compass.prototype.getCurrentHeading=function(a,b,c){if(this.lastHeading==null){this.start(c)}else{if(typeof a=="function"){a(this.lastHeading)}}};Compass.prototype.watchHeading=function(a,c,d){this.getCurrentHeading(a,c,d);var e=100;if(typeof(d)=="object"&&d.frequency){e=d.frequency}var b=this;return setInterval(function(){b.getCurrentHeading(a,c,d)},e)};Compass.prototype.clearWatch=function(a){clearInterval(a)};Compass.prototype.setHeading=function(c){this.lastHeading=c;for(var a=0;a<this.callbacks.onHeadingChanged.length;a++){var b=this.callbacks.onHeadingChanged.shift();b(c)}};Compass.prototype.setError=function(b){this.lastError=b;for(var a=0;a<this.callbacks.onError.length;a++){var c=this.callbacks.onError.shift();c(b)}};Compass.prototype.start=function(a){PhoneGap.exec("Location.startHeading",a)};Compass.prototype.stop=function(){PhoneGap.exec("Location.stopHeading")};PhoneGap.addConstructor(function(){if(typeof navigator.compass=="undefined"){navigator.compass=new Compass()}});function Media(d,a,c,b){if(!d){d="documents://"+String((new Date()).getTime()).replace(/\D/gi,"")}this.src=d;this.successCallback=a;this.errorCallback=c;this.downloadCompleteCallback=b;if(this.src!=null){PhoneGap.exec("Sound.prepare",this.src,this.successCallback,this.errorCallback,this.downloadCompleteCallback)}}Media.prototype.play=function(a){if(this.src!=null){PhoneGap.exec("Sound.play",this.src,a)}};Media.prototype.pause=function(){if(this.src!=null){PhoneGap.exec("Sound.pause",this.src)}};Media.prototype.stop=function(){if(this.src!=null){PhoneGap.exec("Sound.stop",this.src)}};Media.prototype.startAudioRecord=function(a){if(this.src!=null){PhoneGap.exec("Sound.startAudioRecord",this.src,a)}};Media.prototype.stopAudioRecord=function(){if(this.src!=null){PhoneGap.exec("Sound.stopAudioRecord",this.src)}};function MediaError(){this.code=null,this.message=""}MediaError.MEDIA_ERR_ABORTED=1;MediaError.MEDIA_ERR_NETWORK=2;MediaError.MEDIA_ERR_DECODE=3;MediaError.MEDIA_ERR_NONE_SUPPORTED=4;function Notification(){this.resultsCallback=null}Notification.prototype.blink=function(a,b){};Notification.prototype.vibrate=function(a){PhoneGap.exec("Notification.vibrate")};Notification.prototype.beep=function(b,a){new Media("beep.wav").play()};Notification.prototype.alert=function(c,a,e,d){var b={};b.title=(e||"Alert");b.buttonLabel=(d||"OK");this.resultsCallback=a;PhoneGap.exec("Notification.alert",c,b);return};Notification.prototype.confirm=function(b,a,e,d){var c=e?e:"Confirm";var f=d?d:"OK,Cancel";return this.alert(b,a,c,f)};Notification.prototype._alertCallback=function(a){try{this.resultsCallback(a)}catch(b){console.log("Error in user's result callback: "+b)}};Notification.prototype.activityStart=function(){PhoneGap.exec("Notification.activityStart")};Notification.prototype.activityStop=function(){PhoneGap.exec("Notification.activityStop")};Notification.prototype.loadingStart=function(a){PhoneGap.exec("Notification.loadingStart",a)};Notification.prototype.loadingStop=function(){PhoneGap.exec("Notification.loadingStop")};PhoneGap.addConstructor(function(){if(typeof navigator.notification=="undefined"){navigator.notification=new Notification()}});function Orientation(){this.currentOrientation=null}Orientation.prototype.setOrientation=function(a){Orientation.currentOrientation=a;var b=document.createEvent("Events");b.initEvent("orientationChanged","false","false");b.orientation=a;document.dispatchEvent(b)};Orientation.prototype.getCurrentOrientation=function(a,b){};Orientation.prototype.watchOrientation=function(a,b){this.getCurrentPosition(a,b);return setInterval(function(){navigator.orientation.getCurrentOrientation(a,b)},10000)};Orientation.prototype.clearWatch=function(a){clearInterval(a)};PhoneGap.addConstructor(function(){if(typeof navigator.orientation=="undefined"){navigator.orientation=new Orientation()}});function Position(b,a){this.coords=b;this.timestamp=new Date().getTime()}function Coordinates(f,a,e,d,b,c,g){this.latitude=f;this.longitude=a;this.accuracy=d;this.altitude=e;this.heading=b;this.speed=c;this.altitudeAccuracy=(g!="undefined")?g:null}function PositionOptions(){this.enableHighAccuracy=true;this.timeout=10000}function PositionError(){this.code=null;this.message=""}PositionError.UNKNOWN_ERROR=0;PositionError.PERMISSION_DENIED=1;PositionError.POSITION_UNAVAILABLE=2;PositionError.TIMEOUT=3;function Sms(){}Sms.prototype.send=function(e,d,a,b,c){};PhoneGap.addConstructor(function(){if(typeof navigator.sms=="undefined"){navigator.sms=new Sms()}});function Telephony(){}Telephony.prototype.call=function(a){};PhoneGap.addConstructor(function(){if(typeof navigator.telephony=="undefined"){navigator.telephony=new Telephony()}});function NetworkStatus(){this.code=null;this.message=""}NetworkStatus.NOT_REACHABLE=0;NetworkStatus.REACHABLE_VIA_CARRIER_DATA_NETWORK=1;NetworkStatus.REACHABLE_VIA_WIFI_NETWORK=2;function Network(){this.lastReachability=null}Network.prototype.isReachable=function(c,a,b){PhoneGap.exec("Network.isReachable",c,GetFunctionName(a),b)};Network.prototype.updateReachability=function(a){this.lastReachability=a};PhoneGap.addConstructor(function(){if(typeof navigator.network=="undefined"){navigator.network=new Network()}});if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());var Mustache=function(){var a=function(){};a.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(e,d,c,f){if(!f){this.context=d;this.buffer=[]}if(!this.includes("",e)){if(f){return e}else{this.send(e);return}}e=this.render_pragmas(e);var b=this.render_section(e,d,c);if(f){return this.render_tags(b,d,c,f)}this.render_tags(b,d,c,f)},send:function(b){if(b!=""){this.buffer.push(b)}},render_pragmas:function(b){if(!this.includes("%",b)){return b}var d=this;var c=new RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag);return b.replace(c,function(g,e,f){if(!d.pragmas_implemented[e]){throw ({message:"This implementation of mustache doesn't understand the '"+e+"' pragma"})}d.pragmas[e]={};if(f){var h=f.split("=");d.pragmas[e][h[0]]=h[1]}return""})},render_partial:function(b,d,c){b=this.trim(b);if(!c||c[b]===undefined){throw ({message:"unknown_partial '"+b+"'"})}if(typeof(d[b])!="object"){return this.render(c[b],d,c,true)}return this.render(c[b],d[b],c,true)},render_section:function(d,c,b){if(!this.includes("#",d)&&!this.includes("^",d)){return d}var f=this;var e=new RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg");return d.replace(e,function(h,j,g,k){var l=f.find(g,c);if(j=="^"){if(!l||f.is_array(l)&&l.length===0){return f.render(k,c,b,true)}else{return""}}else{if(j=="#"){if(f.is_array(l)){return f.map(l,function(m){return f.render(k,f.create_context(m),b,true)}).join("")}else{if(f.is_object(l)){return f.render(k,f.create_context(l),b,true)}else{if(typeof l==="function"){return l.call(c,k,function(m){return f.render(m,c,b,true)})}else{if(l){return f.render(k,c,b,true)}else{return""}}}}}}})},render_tags:function(k,b,d,f){var e=this;var j=function(){return new RegExp(e.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+e.ctag+"+","g")};var g=j();var h=function(o,m,n){switch(m){case"!":return"";case"=":e.set_delimiters(n);g=j();return"";case">":return e.render_partial(n,b,d);case"{":return e.find(n,b);default:return e.escape(e.find(n,b))}};var l=k.split("\n");for(var c=0;c<l.length;c++){l[c]=l[c].replace(g,h,this);if(!f){this.send(l[c])}}if(f){return l.join("\n")}},set_delimiters:function(c){var b=c.split(" ");this.otag=this.escape_regex(b[0]);this.ctag=this.escape_regex(b[1])},escape_regex:function(c){if(!arguments.callee.sRE){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+b.join("|\\")+")","g")}return c.replace(arguments.callee.sRE,"\\$1")},find:function(c,d){c=this.trim(c);function b(f){return f===false||f===0||f}var e;if(b(d[c])){e=d[c]}else{if(b(this.context[c])){e=this.context[c]}}if(typeof e==="function"){return e.apply(d)}if(e!==undefined){return e}return""},includes:function(c,b){return b.indexOf(this.otag+c)!=-1},escape:function(b){b=String(b===null?"":b);return b.replace(/&(?!\w+;)|["<>\\]/g,function(c){switch(c){case"&":return"&amp;";case"\\":return"\\\\";case'"':return'"';case"<":return"&lt;";case">":return"&gt;";default:return c}})},create_context:function(c){if(this.is_object(c)){return c}else{var d=".";if(this.pragmas["IMPLICIT-ITERATOR"]){d=this.pragmas["IMPLICIT-ITERATOR"].iterator}var b={};b[d]=c;return b}},is_object:function(b){return b&&typeof b=="object"},is_array:function(b){return Object.prototype.toString.call(b)==="[object Array]"},trim:function(b){return b.replace(/^\s*|\s*$/g,"")},map:function(f,d){if(typeof f.map=="function"){return f.map(d)}else{var e=[];var b=f.length;for(var c=0;c<b;c++){e.push(d(f[c]))}return e}}};return({name:"mustache.js",version:"0.3.1-dev",to_html:function(d,b,c,f){var e=new a();if(f){e.send=f}e.render(d,b,c);if(!f){return e.buffer.join("\n")}}})}();var Lawnchair=function(b,a){if(typeof a=="undefined"){throw"Please provide a callback as second parameter to Lawnchair constructor; this shit's async, yo."}if(!JSON||!JSON.stringify){throw"Native JSON functions unavailable - please include http://www.json.org/json2.js or run on a decent browser :P"}this.init(b);a.call(this)};Lawnchair.prototype={init:function(b){var a={webkit:window.WebkitSQLiteAdaptor,gears:window.GearsSQLiteAdaptor,dom:window.DOMStorageAdaptor,cookie:window.CookieAdaptor,air:window.AIRSQLiteAdaptor,userdata:window.UserDataAdaptor,"air-async":window.AIRSQLiteAsyncAdaptor,blackberry:window.BlackBerryPersistentStorageAdaptor,couch:window.CouchAdaptor,server:window.ServerAdaptor};this.adaptor=b.adaptor?new a[b.adaptor](b):new DOMStorageAdaptor(b)},save:function(a,b){this.adaptor.save(a,b)},get:function(a,b){this.adaptor.get(a,b)},exists:function(a){this.adaptor.exists(a)},all:function(a){this.adaptor.all(a)},remove:function(b,a){this.adaptor.remove(b,a)},nuke:function(a){this.adaptor.nuke(a);return this},paged:function(a,b){this.adaptor.paged(a,b)},find:function(condition,callback){var is=(typeof condition=="string")?function(r){return eval(condition)}:condition,cb=this.adaptor.terseToVerboseCallback(callback);this.each(function(record,index){if(is(record)){cb(record,index)}})},each:function(b){var a=this.adaptor.terseToVerboseCallback(b);this.all(function(e){var c=e.length;for(var d=0;d<c;d++){a(e[d],d)}})}};var LawnchairAdaptorHelpers={merge:function(a,b){return(b==undefined||b==null)?a:b},terseToVerboseCallback:function(callback){return(typeof arguments[0]=="string")?function(r,i){eval(callback)}:callback},now:function(){return new Date().getTime()},uuid:function(a,d){var f="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var c=[];d=d||f.length;if(a){for(var b=0;b<a;b++){c[b]=f[0|Math.random()*d]}}else{var e;c[8]=c[13]=c[18]=c[23]="-";c[14]="4";for(var b=0;b<36;b++){if(!c[b]){e=0|Math.random()*16;c[b]=f[(b==19)?(e&3)|8:e]}}}return c.join("")},serialize:function(b){var a="";a=JSON.stringify(b);return a},deserialize:function(json){return eval("("+json+")")}};var WebkitSQLiteAdaptor=function(a){for(var b in LawnchairAdaptorHelpers){this[b]=LawnchairAdaptorHelpers[b]}this.init(a)};WebkitSQLiteAdaptor.prototype={init:function(a){var c=this;var d=c.merge;var b=(typeof arguments[0]=="string")?{table:a}:a;this.name=d("Lawnchair",b.name);this.version=d("1.0",b.version);this.table=d("field",b.table);this.display=d("shed",b.display);this.max=d(65536,b.max);this.db=d(null,b.db);this.perPage=d(10,b.perPage);this.onError=function(){};this.onData=function(){};if("onError" in b){this.onError=b.onError}if(typeof b.callback!=="function"){b.callback=function(){}}if(!window.openDatabase){throw ('Lawnchair, "This browser does not support sqlite storage."')}if(!WebkitSQLiteAdaptor.globaldb){WebkitSQLiteAdaptor.globaldb=openDatabase(this.name,this.version,this.display,this.max)}this.db=WebkitSQLiteAdaptor.globaldb;c.db.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+c.table+" (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT, timestamp REAL)",[],b.callback,c.onError)})},save:function(c,e){var a=this;var d=function(h,f,g){a.db.transaction(function(j){j.executeSql("UPDATE "+a.table+" SET value=?, timestamp=? WHERE id=?",[a.serialize(f),a.now(),h],function(){if(g!=undefined){f.key=h;a.terseToVerboseCallback(g)(f)}},a.onError)})};var b=function(f,g){a.db.transaction(function(h){var j=(f.key==undefined)?a.uuid():f.key;delete (f.key);h.executeSql("INSERT INTO "+a.table+" (id, value,timestamp) VALUES (?,?,?)",[j,a.serialize(f),a.now()],function(){if(g!=undefined){f.key=j;a.terseToVerboseCallback(g)(f)}},a.onError)})};if(c.key==undefined){b(c,e)}else{this.get(c.key,function(f){var g=(f!=null);if(g){var h=c.key;delete (c.key);d(h,c,e)}else{b(c,e)}})}},get:function(a,c){var b=this;this.db.transaction(function(d){d.executeSql("SELECT value FROM "+b.table+" WHERE id = ?",[a],function(e,f){if(f.rows.length==0){b.terseToVerboseCallback(c)(null)}else{var g=b.deserialize(f.rows.item(0).value);g.key=a;b.terseToVerboseCallback(c)(g)}},this.onError)})},all:function(c){var a=this.terseToVerboseCallback(c);var b=this;this.db.transaction(function(d){d.executeSql("SELECT * FROM "+b.table,[],function(f,j){if(j.rows.length==0){a([])}else{var k=[];for(var h=0,e=j.rows.length;h<e;h++){var g=j.rows.item(h).value;var m=b.deserialize(g);m.key=j.rows.item(h).id;k.push(m)}a(k)}},b.onError)})},paged:function(c,d){var a=this.terseToVerboseCallback(d);var b=this;this.db.transaction(function(e){var g=b.perPage*(c-1);var f="SELECT * FROM "+b.table+" ORDER BY timestamp ASC LIMIT ? OFFSET ?";e.executeSql(f,[b.perPage,g],function(j,n){if(n.rows.length==0){a([])}else{var o=[];for(var m=0,h=n.rows.length;m<h;m++){var k=n.rows.item(m).value;var p=b.deserialize(k);p.key=n.rows.item(m).id;o.push(p)}a(o)}},b.onError)})},remove:function(c,b){var a=this;if(b){b=a.terseToVerboseCallback(b)}this.db.transaction(function(d){d.executeSql("DELETE FROM "+a.table+" WHERE id = ?",[(typeof c=="string")?c:c.key],b||a.onData,a.onError)})},nuke:function(b){var a=this;if(b){b=a.terseToVerboseCallback(b)}this.db.transaction(function(c){c.executeSql("DELETE FROM "+a.table,[],b||a.onData,a.onError)})}};if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)){function URLCache(){this._cache={};this._callbacks={}}URLCache.prototype._onCacheCallbackSuccess=function(b,a){this._cache[b]=a;this._callbacks[b].onSuccess(b,a)};URLCache.prototype._onCacheCallbackFail=function(b,a){this._callbacks[b].onFail(b,a)};URLCache.prototype.getCachedPathforURI=function(a,b,c){if(this._cache[a]==null){this._callbacks[a]={onSuccess:b,onFail:c};PhoneGap.exec("URLCache.getCachedPathforURI",a)}return this._cache[a]};PhoneGap.addConstructor(function(){if(!window.plugins){window.plugins={}}if(!window.plugins.urlCache){window.plugins.urlCache=new URLCache()}})}else{if(navigator.userAgent.match(/browzr/i)){function Cache(){}Cache.prototype.getCachedPathForURI=function(b,c,a){return PhoneGap.execAsync(function(e){var d=JSON.parse(e.message);c(b,d.file)},function(d){d=(typeof d!=="string")?JSON.stringify(d):d;a(b,d)},"ca.rnao.bpg.plugins.URLCache","getCachedPathForURI",[b,"RNAO"])};PhoneGap.addPlugin("urlCache",new Cache())}else{if(navigator.userAgent.match(/blackberry\d*\/(5|6)\..*/i)){function Cache(){}Cache.prototype.getCachedPathForURI=function(b,c,a){return PhoneGap.exec(function(e){var d=JSON.parse(e);c(b,d.file)},function(d){d=(typeof d!=="string")?JSON.stringify(d):d;a(b,d)},"URLCache","getCachedPathForURI",[b,"RNAO"])};PhoneGap.addPlugin("urlCache",new Cache())}}}if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)){function ImageCacheManager(){this.imageCache={};this.hasPendingDownload=false;this.downloadQueue=[]}ImageCacheManager.prototype.getCachedImage=function getCachedImage(c,d,b){var a={uri:c,onSuccess:d,onError:b};this.downloadQueue.push(a);this._getNextImage()};ImageCacheManager.prototype._getNextImage=function _getNextImage(){if(this.downloadQueue.length>0&&!this.hasPendingDownload){this.hasPendingDownload=true;var d=this.downloadQueue.shift();var b=this;var a=function(e,f){d.onSuccess(e,f);b.onSuccess(e,f)};var c=function(f,e){d.onError(f,e);b.onFail(f,e)};a(d.uri,d.uri)}};ImageCacheManager.prototype.onSuccess=function onSuccess(a,b){this.imageCache[a]={url:b};this.hasPendingDownload=false;this._getNextImage()};ImageCacheManager.prototype.onFail=function onFail(b,a){this.hasPendingDownload=false;this._getNextImage()};if(!window.plugins){window.plugins={}}if(!window.plugins.urlCacheManager){window.plugins.urlCacheManager=new ImageCacheManager()}}else{if(navigator.userAgent.match(/browzr/i)||navigator.userAgent.match(/blackberry\d*\/(5|6)\..*/i)){function ImageCacheManager(){this.imageCache={}}ImageCacheManager.prototype.getCachedImage=function(b,e,a){var d=this.imageCache[b],c="";if(d){e(b,d)}else{c=window.plugins.urlCache.getCachedPathForURI(b,e,a)}return c};PhoneGap.addPlugin("urlCacheManager",new ImageCacheManager())}}(function(a){a.Application={stageName:"wrapper",actions:["action","template","render","selectors"],clickable:true,events:{},please:{},settings:{},device:"",init:function(){this.reset();x$("body").click(function(h){if(!Application.clickable){return this}var f=function(e){while(!e.href&&e.parentNode){e=e.parentNode}return e};var d=f(h.target);var c=null;var g=null;if(d&&d.href){c=d.href;g=d.href.match(/#.*$/)}if(g){if(!Application.is("blackberry4")){x$(d).addClass("selected")}g=g[0].replace("#","");if(g!==""){if(Application.events[g]){Application.trigger(g,d)}else{if(Application.is("blackberry4")){document.location.hash="#"+g}else{var b=x$("a[name="+g+"]");b=(b.length>0)?b:x$("#"+g);if(b.length>0){b[0].scrollIntoView(true)}}}}}else{if(c){Application.reachable(function(e){if(e){if(Application.supports.browser.widget){blackberry.invoke.invoke(blackberry.invoke.APP_BROWSER,new blackberry.invoke.BrowserArguments(c))}else{document.location=c}}else{navigator.notification.alert(Const.MSG_CANNOT_OPEN_PAGE,Const.MSG_CANNOT_OPEN_PAGE_TITLE)}})}}return false});if(window.onorientationchange){window.onorientationchange=this.updateSize}},reset:function(){this.events={};this.please={};this.device=this.findDevice();var b=x$(document.createElement("div")).attr("id",this.stageName);document.body.appendChild(b[0]);this.updateSize()},updateSize:function(){x$("html").setStyle("height",screen.height+"px");x$("body").setStyle("height",screen.height+"px");x$("#"+this.stageName).setStyle("height",screen.height+"px")},on:function(c,d){var b=this;this.events[c]=d;switch(c){case"init":window.addEventListener("load",function(f){b.trigger("init",f)},false);break;case"ready":document.addEventListener("deviceready",function(f){b.trigger("ready",f)},false);break}return this},trigger:function(c,g){var f=this;if(!f.events[c]){return f.render(c,g)}if(g&&g.nodeName){var b={};for(var d=0;d<g.attributes.length;d++){b[g.attributes[d].name]=g.attributes[d].value}g=b}var e=f.events[c];var h=f.actions.slice(0);if(typeof e==="function"){e.call(e,g)}else{f._runActions(c,e,h,g,g)}return this},isClickable:function(b){this.clickable=b},_runActions:function(c,b,e,l,f){var d=e.shift();var m=this;if(d==="action"){if(!b.action){return this}b.action.call(b,f,function(n){m._runActions(c,b,e,l,n)})}else{if(d==="template"){if(!b.template){return this}var j=b.template.call(b,f);m._runActions(c,b,e,l,j)}else{if(d==="render"){var k=this.render(c,f);m._runActions(c,b,e,l,k)}else{if(d==="selectors"){for(var h in b.selectors){if(b.selectors.hasOwnProperty(h)){var g=b.selectors[h];g.call(l,x$(h))}}}}}}return this},render:function(d,f){var c=x$("#"+d+"-template");var f=f||{};var b=null;var e=Mustache.to_html(c.html(),f);if(c.hasClass("view")){b=x$("#"+this.stageName);b.html(e);x$("body > div.modal").remove();setTimeout(function(){window.scrollTo(0,0)},10)}else{if(c.hasClass("modal")){b=x$(document.createElement("div")).attr("id",d).addClass("modal");b.setStyle("height",this.height()+"px");b.html(e);x$("body")[0].appendChild(b[0]);x$("#"+this.stageName+" .selected").removeClass("selected");setTimeout(function(){window.scrollTo(0,0)},10)}else{if(c.hasClass("partial")){b=x$("#"+f.target);b.html(e)}else{console.log("Template: unknown class")}}}return b},is:function(b){return(b===this.device)},findDevice:function(){var b=navigator.userAgent;if(b.match(/browzr/i)){return"blackberry4"}if(b.match(/blackberry\d*\/4\..*/i)){return"blackberry4"}if(b.match(/blackberry\d*\/5\..*/i)){return"blackberry5"}if(b.match(/blackberry\d*\/6\..*/i)){return"webkit"}if(b.match(/webkit/i)){return"webkit"}return"desktop"},reachable:function(b){navigator.network.isReachable(Const.DOMAIN,function(c){c=(typeof c==="number")?c:parseInt(c);b((c!==NetworkStatus.NOT_REACHABLE))})},dispatch:function(b){setTimeout(b,10)},height:function(){return document.body.scrollHeight||window.innerHeight}};a.Application.init.call(Application);if(typeof console==="undefined"){window.console={log:function(b){}}}})(window);(function(){var a=new Image();a.onload=function(){delete a};a.src="style/loading_foreground.png"})();Application.on("init",function(a){Application.trigger("splashScreen",{})});Application.on("ready",function(a){var b=["style/bg_black.png","style/icon_arrow.png","style/loader/default.gif","style/loader/small.gif","style/loader/white.gif","style/loader/grey.gif","style/sprites.png"];Application.please.preloadImages(b,function(){alert("settings");Application.please.loadSettings();alert("features");Application.please.detectFeatures();alert("database");Application.please.createDatabase(function(){alert("home");Application.trigger("home",{skipLoading:true})})})});Application.on("splashScreen",{action:function(b,a){a(b)},template:function(a){return{}},selectors:{"#wrapper":function(a){x$("#splashScreen").setStyle("height",screen.height+"px")}}});Application.on("home",{action:function(b,a){Application.isClickable(false);if(b&&!b.skipLoading){Application.trigger("loading",{title:"Home"})}Application.please.xhr(Const.DOMAIN+Const.URL_HOME,{success:function(c){a(c.data)}})},template:function(b){var a={last_label:"",items:b,header:function(){return this[Const.TERM_DATA_NAME]},has_label:function(){return(a.last_label!==a.header.call(this)[0])},label_title:function(){var c=a.header.call(this)[0];a.last_label=c;return c}};return a},selectors:{"#wrapper":function(a){a.removeClass("double");Application.isClickable(true);if(Application.supports.splashScreen.hide){window.plugins.splashScreen.hide()}},".ellipsis":function(a){a.each(function(b){Application.please.ellipsis(b)})}}});Application.on("list",{action:function(b,a){Application.isClickable(false);Application.trigger("loading",{title:b.header});Application.please.xhr(Const.DOMAIN+Const.URL_VIEW2+b.tid,{success:function(c){c.data.current_title=b.header;c.data.current_id=b.tid;a(c.data)}})},template:function(b){var a={last_label:"",items:b,current_id:b.current_id,header:function(){return this.node_title},has_label:function(){return(a.last_label!==this[Const.TERM_DATA_NAME])},label_title:function(){var c=this[Const.TERM_DATA_NAME];a.last_label=c;return c},current_title:b.current_title};return a},selectors:{"#wrapper":function(a){a.addClass("double");Application.isClickable(true)},".ellipsis":function(a){a.each(function(b){Application.please.ellipsis(b)})}}});Application.on("page",{action:function(b,a){Application.isClickable(false);Application.trigger("loading",{title:b.header});Application.please.xhr(Const.DOMAIN+Const.URL_PAGE+b.nid,{success:function(d){d.data.current_title=b.header;d.data.current_id=b.nid;for(var c in d.data.taxonomy){var e=d.data.taxonomy[c];if(e.vid==="1"){d.data.tax=e;break}}a(d.data)}})},template:function(b){var a={tax:{id:b.tax.tid.toString(),full_name:b.tax.name,short_name:function(){return b.tax.name}},current_title:b.current_title,current_id:b.current_id,parent_id:b.tax.tid,content:b.body};return a},selectors:{"#wrapper":function(a){a.addClass("double");Application.isClickable(true)},".ellipsis":function(a){a.each(function(b){Application.please.ellipsis(b)})}}});Application.on("next",{action:function(d,a){var e=(d.direction==="left");var c=(d.tid)?"tid":"nid";var f=d[c];var b=Const.DOMAIN+((d.parentid)?Const.URL_VIEW2+d.parentid:Const.URL_HOME);Application.isClickable(false);Application.please.xhr(b,{success:function(j){for(var h=0;h<j.data.length;h++){if(j.data[h][c]===f){var k={};var g=0;if(h<=0&&e){g=j.data.length-1}else{if(h>=j.data.length-1&&!e){g=0}else{g=h+(e?-1:1)}}var k=j.data[g];k.header=k.node_title||k[Const.TERM_DATA_NAME];var l=(d.tid)?"list":"page";Application.trigger(l,k);a();break}}}})}});Application.on("update",{action:function(b,a){Application.reachable(function(c){if(c){Application.update.start();a()}else{navigator.notification.alert(Const.MSG_CANNOT_UPDATE)}})},template:function(a){return{}},selectors:{"#progress-modal":function(a){}}});Application.on("update-progress",function(a){if(!x$("#update")[0]){return}if(a.percentage){var b=a.percentage;if(b>100){b=100}if(b<0){b=0}var c=b.toString()+"%";x$(".progress-status").html(c);x$(".progress-bar").setStyle("width",c)}if(a.status){x$("#progress_message").html(a.status)}});Application.on("update-close",function(a){Application.update.stop();if(x$("#update")[0]){x$("#update").remove()}});Application.on("fontScale",function(b){Application.settings.fontSizeIndex++;if(Application.settings.fontSizeIndex>=Const.FONT_SIZES.length){Application.settings.fontSizeIndex=0}var a=Const.FONT_SIZES[Application.settings.fontSizeIndex].toString()+"px";document.body.style.fontSize=a});Application.on("search",{action:function(b,a){a(null)},template:function(a){return{}},selectors:{"#search-input":function(a){a[0].focus();a[0].onkeypress=function(b){if(b.keyCode===13||b.keyCode===10){Application.trigger("searchResults")}}}}});Application.on("closeSearch",function(a){x$("#search").remove()});Application.on("searchResults",{action:function(d,b){var c=x$("#search-input")[0].value;Application.trigger("searchLoader",{query:c});c=encodeURIComponent(c);var a=Const.DOMAIN+Const.URL_SEARCH+c;Application.please.xhr(a,{readCache:false,writeCache:false,success:function(e){b(e)},fail:function(){Application.please.searchOffline(c,b)}})},template:function(a){if(a.error){a.error={message:a.data};a.data=""}return{target:"result",error:a.error,results:a.data,nid:function(){return this.node}}},selectors:{"#search-input":function(a){a.removeClass("selected");a[0].blur()}}});Application.on("searchLoader",{action:function(b,a){a(b)},template:function(a){return{target:"result",query:a.query}}});Application.on("network-error",{action:function(b,a){Application.isClickable(true);a(b)},template:function(a){return{}},selectors:{"#bt-retry":function(a){var b=this;a.click(function(c){Application.please.xhr(b.url,b.options);x$("#network-error").remove()})},"#bt-retry-close":function(a){a.click(function(b){x$("#network-error").remove()})}}});Application.on("loading",{action:function(b,a){if(Application.is("blackberry4")||Application.is("blackberry5")){b=b||{};a(b)}else{delete this}},template:function(a){return{title:function(){return a.title||""}}},selectors:{".ellipsis":function(a){a.each(function(b){Application.please.ellipsis(b)})}}});var Const={FONT_SIZES:[13,15,17],SLIDE_INTERVAL:15,SLIDE_FRAME:9,FADE_SPEED:0.2,ELLIPSIS_BREAD:35,ELLIPSIS_LABEL:70,ELLIPSIS_LOADING:25,ELLIPSIS_TITLE:60,DEVICE_IPHONE:"ios",DEVICE_BLACKBERRY:"blackberry",DEVICE_DESKTOP:"desktop",TERM_DATA_NAME:"term_data_name",IPHONE:{SLIDE_INTERVAL:85,SLIDE_FRAME:3,FADE_SPEED:0.6,NETWORK_TIMEOUT_DURATION:20000},BLACKBERRY:{NETWORK_TIMEOUT_DURATION:60000},NETWORK_TIMEOUT_DURATION:15000,DOMAIN:"http://pda.rnao.ca",URL_HOME:"/services/json/?sessid=36475b3012af98851b74e4f5251d183f&method=views.get&view_name=all_guidelines_available",URL_VIEW2:"/services/json/?sessid=36475b3012af98851b74e4f5251d183f&method=views.get&view_name=guideline_content_types&args=",URL_PAGE:"/services/json/?sessid=16f5b876d0a2b0195840cf64482519c5&method=node.get&fields=title,body,taxonomy,changed&nid=",URL_SEARCH:"/services/json/?sessid=16f5b876d0a2b0195840cf64482519c5&method=search.nodes&simple=true&search_keys=",URL_NODE_TIMESTAMPS:"/services/json/?sessid=16f5b876d0a2b0195840cf64482519c5&method=node_resource.index&fields=changed,nid",URL_VIEW_GLOBAL:"/services/json/?sessid=36475b3012af98851b74e4f5251d183f&method=pda.timestamp.global",URL_VIEW_TIMESTAMPS:"/services/json/?sessid=36475b3012af98851b74e4f5251d183f&method=pda.timestamp.list",MIN_VIEW_COUNT:46,MAX_VIEW_OVERFLOW:10,MAX_XHR_FAILURE:3,TMP_DETAIL:'<div class="detail">TEXT</div>',TMP_LABEL:'<div class="label">TEXT</div>',TMP_BREAD:'<a href="#" class="CLASS_NAME" id="bt-home">Home</a>',TMP_NAV:'<div class="bt-container"><a class="bt arrow left" href="#" id="bt-left"></a></div><div class="bt-container right"><a class="bt arrow right" href="#" id="bt-right"></a></div><div id="title">TEXT</div>',TMP_BACK_TO_TOP:'<div class="item back" onclick="App.backToTop();">Back to Top</div>',TMP_MESSAGE:'<div class="message">TEXT</div>',TMP_ERROR_NETWORK:'<div class="float-modal"><a href="#" id="bt-retry-close" class="bt round close"></a><p><b>Network is unavailable.</b></p><a id="bt-retry" href="#" class="bt-modal">Retry</a></div>',TMP_ERROR_INITIAL:'<div class="float-modal tall"><h2>Network Error</h2><p><b>Please make sure you have an internet connection when running this application for the first time.</b></p><a id="bt-retry" href="#" class="bt-modal">Retry</a></div>',TMP_PROGRESS:'<div class="float-modal large"><a href="#" id="progress-close" class="bt round close" onclick="ProgressModal.onCancelClick();return false;"></a><p id="progress_message">Finding outdated items...</p><div class="progress-bar-container"><div class="progress-bar"></div></div><div class="progress-status">0%</div><div class="progress-description">Downloading new and updated articles for offline viewing.<br />This can take <span class="emphasis">5 - 10 minutes</span>.</div><a id="bt-pause" href="#" class="bt-modal" onclick="ProgressModal.onPauseClick();return false;">Pause</a><a id="bt-cancel" href="#" class="bt-modal" onclick="ProgressModal.onCancelClick();return false;">Cancel</a><a id="bt-resume" href="#" class="bt-modal" style="display:none;" onclick="ProgressModal.onResumeClick();return false;">Resume</a></div>',TMP_WRAP_INNER:'<div id="new-header" class="header" ontouchmove="preventMove(event);"><div id="new-bread" class="bread"></div><div class="right right-edge"><a class="bt left update" href="#" id="bt-update"></a><a class="bt left font" href="#" id="bt-font"></a><a class="bt left search" href="#" id="bt-search"></a></div><div id="new-nav" class="nav"></div></div><div id="new-list" class="list" ontouchmove="listTouchMove(event)" ontouchstart="listTouchStart(event);" ontouchend="touchEnd(event);"></div><div id="modal" style="display:none"><div id="search-header" class="header"><div class="left left-edge"><a class="bt right close round" href="#" id="bt-close-search"></a></div><input id="search-input" type="text" value="" /><div class="right right-edge"><a class="bt left search" href="#" id="bt-start-search"></a></div></div><div id="result" class="list" ontouchmove="resultTouchMove(event)" ontouchstart="resultTouchStart(event);" ontouchend="touchEnd(event);"></div></div>',TMP_OFFLINE_ONCLICK:" onclick=\"navigator.notification.alert('Sorry, the link cannot be opened because there is no network connection.', 'Cannot Open Page'); return false;\" ",PROGRESS_MSG_INVENTORY_NODES:"Finding outdated guides...",PROGRESS_MSG_INVENTORY_VIEWS:"Finding outdated lists...",PROGRESS_MSG_BB_FIND_EXPIRED:"Organizing the guides...",PROGRESS_MSG_NODES:"Downloading guides...",PROGRESS_MSG_VIEWS:"Downloading lists...",MSG_CANNOT_UPDATE:"Sorry, you need a network connection to run the updater.",MSG_INSTALL_DB:"The application is about to install the database.\nThis may take a few minutes.",MSG_NO_RESULTS:"Search returned no results.",MSG_CANNOT_OPEN_PAGE:"Sorry, the link cannot be opened because there is no network connection.",MSG_CANNOT_OPEN_PAGE_TITLE:"Cannot open page",DB_INFO:"internal_info"};Application.please.loadSettings=function(){var a={webkit:"webkit",blackberry4:"blackberry",blackberry5:"gears"};Application.settings={fontSizeIndex:0,database:{backup:false,backupPath:Application.please.getStoragePath()+"database.json",table:"offline",name:"rnao",adaptor:a[Application.device],created:new Date(1294428208831)},xhr:{timeout:Const.IPHONE.NETWORK_TIMEOUT_DURATION}}};Application.please.detectFeatures=function(){var a=document.createElement("a");Application.supports={browser:{widget:!!(typeof blackberry!=="undefined"&&blackberry.invoke&&blackberry.invoke.BrowserArguments)},database:{sqliteGears:(Application.settings.database.adaptor==="gears"),sqliteWebkit:(Application.settings.database.adaptor==="webkit"),sqlite:(Application.settings.database.adaptor==="webkit"||Application.settings.database.adaptor==="gears")},ellipsis:(typeof a.style.textOverflow!=="undefined"),splashScreen:{hide:!!(window.plugins&&window.plugins.splashScreen&&window.plugins.splashScreen.hide)},network:{XHR:!!(navigator.network&&navigator.network.XHR)},event:{orientationChange:(window&&window.orientationchange!=="undefined")},file:{reader:(typeof FileReader!=="undefined"),writer:(typeof FileWriter!=="undefined")},store:{backup:!!(window.plugins&&window.plugins.store&&window.plugins.store.backup),restore:!!(window.plugins&&window.plugins.store&&window.plugins.store.restore),search:!!(window.plugins&&window.plugins.store&&window.plugins.store.search)},update:{findExpired:!!(window.plugins&&window.plugins.update&&window.plugins.update.findExpired)},urlCacheManager:{getCachedImage:!!(window.plugins&&window.plugins.urlCacheManager&&window.plugins.urlCacheManager.getCachedImage)}};delete a};Application.please.preloadImages=function(c,d){var b=null;var a=function(){if(b!==null){delete b}if(c.length<=0){Application.dispatch(d);return}b=new Image();b.onload=a;b.src=c.pop()};a()};Application.please.ellipsis=function(c){if(Application.supports.ellipsis){return}var a=x$(c);var d=0;if(a.attr("id")[0]==="title"){d=Const.ELLIPSIS_TITLE}else{if(a.hasClass("label")){d=Const.ELLIPSIS_LABEL}else{if(a.attr("id")[0]==="loading-title"){d=Const.ELLIPSIS_LOADING}else{d=Const.ELLIPSIS_BREAD}}}var b=c.innerHTML;if(c.innerHTML.length>d){c.innerHTML=c.innerHTML.substring(0,d)+"..."}};Application.please.generateKey=function(a){return a.replace(/^http:\/\//,"").replace(/^www./,"").replace(/[\/&]$/,"")};Application.please.generateAbsoluteURL=function(a){if(a.search(/^http:\/\//)>=0||a.search(/^www./)>=0||a[0]==="#"){return a}else{return Const.DOMAIN+"/"+a.replace(/^\//,"")}};Application.please.extend=function(c,b){for(var a in b){if(typeof c[a]==="undefined"){c[a]=b[a]}}};Application.please.getStoragePath=function(){var c="";if(typeof navigator!=="undefined"&&navigator.fileMgr){var b=navigator.fileMgr.getRootPaths();for(var a=0;a<b.length;a++){if(b[a].indexOf("SDCard")!=-1){c=b[a];break}}}return c};Application.please.createDatabase=function(a){if(typeof Lawnchair==="undefined"){a();return}if(Application.settings.database.adaptor==="blackberry"&&!navigator.store){a();return}Application.dispatch(function(){new Lawnchair(Application.settings.database,function(){Application.database=this;Application.please.migrateDatabase({using:Application.please.restoreDatabase,completed:a})})})};Application.please.migrateDatabase=function(a){var b=function(e){if(!e||!e.creation_date){return true}var d=new Date(e.creation_date);var c=Application.settings.database.created;if(!d.getTime()){return true}if(d.getTime()<c.getTime()){return true}return false};Application.database.get(Const.DB_INFO,function(c){if(b(c)){a.using(a.completed)}else{a.completed()}})};Application.please.restoreDatabase=function(a){alert(Const.MSG_INSTALL_DB);Application.database.nuke(function(){var b=function(){var c=new Date();Application.database.save({key:Const.DB_INFO,creation_date:c.getTime()},function(){a()})};Application.please.restore(b)})};Application.please.backupDatabase=function(){if(!Application.settings.database.backup){return}var c={success:function(d){alert("Success: "+d.target.fileName+" "+d.type)},fail:function(d){alert("Failed to write the file: "+d)}};if(Application.supports.file.writer){try{var a=new FileWriter(Application.settings.database.backupPath,false);a.onwriteend=c.success;Application.database.all(function(d){a.write(JSON.stringify(d))})}catch(b){c.fail(b)}}else{if(Application.supports.store.backup){window.plugins.store.backup(c.success,c.fail)}}};Application.please.restore=function(e){var a=function(h){var g=0;var f=function(){var j=function(k,l){Application.dispatch(function(){var o=google.gears.factory.create("beta.database");var n=new Date().getTime();o.open(Application.settings.database.name);o.execute("BEGIN");while(k.length>0){var m=k.shift();var p=m.key;delete m.key;o.execute("INSERT INTO "+Application.settings.database.table+" (id, value, timestamp) VALUES (?, ?, ?)",[p,JSON.stringify(m),n]);delete p;delete m}o.execute("COMMIT");o.close();Application.dispatch(l)})};PhoneGap.exec(function(k){var l=JSON.parse(k);g+=l.length;(l.length>0)?j(l,f):h();delete l},function(k){alert("error from native: "+k)},"Database","chunk",[])};f()};var b=function(g){var f=new FileReader();f.onerror=function(){g()};f.onload=function(n){var j=JSON.parse(n.target.result);delete n;var m=function(o){g()};var h=function(){g()};var k=function(q){for(var p=0,o=j.length;p<o;p++){var r=j[p].key;delete j[p].key;q.executeSql("INSERT INTO "+Application.settings.database.table+" (id, value,timestamp) VALUES (?,?,?)",[r,JSON.stringify(j[p]),Date.now()])}};var l=window.openDatabase(Application.settings.database.name,"1.0","shed",65536);l.transaction(k,m,h)};f.readAsText("local:///database/database.json")};var c=function(f){window.plugins.store.restore(f,f)};var d=function(f){PhoneGap.exec(function(){f()},function(g){f()},"Database","restoreImages",[])};if(Application.supports.database.sqliteGears){a(function(){d(e)})}else{if(Application.supports.file.reader&&Application.supports.database.sqlite){b(function(){d(e)})}else{if(Application.supports.store.restore){c(function(){d(e)})}else{e()}}}};Application.cache=Application.cache||{};Application.cache.find=function(b,a){Application.please.extend(a,{readCache:true,success:function(c){console.log("Consumed cache find success.")},fail:function(){console.log("Consumed cache find fail.")}});if(!Application.database||!a.readCache){a.fail();return}Application.database.get(b,function(c){if(!c){a.fail();return}if(Application.is("blackberry4")){var d=c.data||c["#data"];if(typeof d[d.length-1]==="function"){d.pop()}}a.success(c.data)})};Application.cache.write=function(c,b,g){var e=function(){Application.dispatch(function(){(Application.database)?Application.database.save({key:c,data:b},g):g()})};if(!Application.supports.urlCacheManager.getCachedImage){return e()}if(b.data&&b.data.body){var f={uri:{},requestCount:0,responseCount:0};var a=function(h,j){window.plugins.urlCacheManager.getCachedImage(h,function(k,l){f.uri[k]=l;f.responseCount++},function(l,k){if(j<Const.MAX_XHR_FAILURE){a(h,++j)}else{f.uri[l]=l;f.responseCount++}})};b.data.body.replace(/\<\ *img[^\>]*src\ *=\ *['"]([^\"\'\ >]*)['"][^\>]*>/ig,function(h,j){f.requestCount++;a(j,0);return h});var d=setInterval(function(){if(f.responseCount<f.requestCount){return}clearInterval(d);b.data.body=b.data.body.replace(/\<\ *img[^\>]*src\ *=\ *['"]([^\"\'\ >]*)['"][^\>]*>/ig,function(h,j){var k=f.uri[j];if(typeof(k)==="object"){k=k.url}h=h.replace(j,k);return h});e()},300)}else{e()}};Application.please.xhr=function(c,b){this.extend(b,{success:function(g){console.log("XHR success consumed.")},fail:function(){Application.trigger("network-error",{url:c,options:b})},readCache:true,writeCache:true});var d=this.generateKey(c);Application.settings.xhr.failureAttempt=0;var e=function(){Application.settings.xhr.failureAttempt++;console.log("Robust failure activated");if(Application.settings.xhr.failureAttempt>Const.MAX_XHR_FAILURE){b.fail()}else{a()}};var a=function(){Application.reachable(function(g){(g)?f():e()})};var f=function(){var g=function(h){h=Application.please._normalizeResponse(h,b);if(b.writeCache){Application.cache.write(d,h,function(){b.success(h)})}else{b.success(h)}};Application.please._xhr(c,{success:g,fail:e})};Application.dispatch(function(){Application.cache.find(d,{readCache:b.readCache,success:b.success,fail:a})})};Application.please._xhr=function(c,b){this.extend(b,{success:function(e){console.log("_XHR success consumed.")},fail:function(){console.log("_XHR fail consumed.")},readCache:true,writeCache:true});if(Application.supports.network.XHR){navigator.network.XHR(c,null,function(e){if(!e||e.error){b.fail();return}b.success(e)})}else{var d=new XMLHttpRequest();d.open("GET",c,true);d.setRequestHeader("Cache-Control","no-cache");d.setRequestHeader("Content-type","text/plain;charset=UTF-8");d.onreadystatechange=function(){if(d.readyState===4&&d.status===200){clearTimeout(a);b.success(d.responseText)}};d.send();var a=null;if(!navigator.userAgent.match(/blackberry\d*\/6\..*/i)){a=setTimeout(function(){d.abort();b.fail()},Application.settings.xhr.timeout)}}};Application.please._normalizeResponse=function(response,options){this.extend(options,{success:function(json){console.log("_noramlizeResponse success consumed.")},fail:function(){console.log("_normalizeResponse error consumed.")}});if(!response){options.fail();return}else{if(typeof response==="string"){response=response.replace(/#data/gi,"data").replace(/#error/gi,"error")}else{if(response["#data"]){response.data=response["#data"];response.error=response["#error"];delete response["#data"];delete response["#error"]}}}if(typeof response==="string"){response=eval("("+response+")")}if(typeof response!=="object"){options.fail();return}if(response.data&&response.data.body){response.data.body=response.data.body.replace(/\<\ *(a|img)[^\>]*(href|src)\ *=\ *['"]([^\"\'\ >]*)['"][^\>]*\>/gi,function(tag,tagName,tagType,tagURL){return tag.replace(tagURL,Application.please.generateAbsoluteURL(tagURL))})}return response};Application.please.searchOffline=function(f,g){var d={error:false,data:[]};var e=function(h){d.error=true;d.data=h};f=Application.please._formatSearchString(f);if(!Application.database){e("There is no database to search.");g(d);return}else{if(typeof f!=="string"||f.length<=0){e(Const.MSG_NO_RESULTS);g(d);return}}var a=new RegExp(f,"gi");var b=function(j){if(!j){return}var k=j.data;var m=j.key;var l=0;if(!k||!k.data||!k.data.title){return}var h=k.data.title.match(a);if(h){d.data.push({title:k.data.title,node:Application.please_findNodeIdFromUrl(m)})}};var c=function(){if(d.data.length<=0){e(Const.MSG_NO_RESULTS)}g(d)};if(Application.supports.store.search){window.plugins.store.search(f,function(h){d.data=h.message.data;d.error=h.message.error;c()})}else{Application.database.all(function(h){for(var j=0;j<h.length;j++){b(h[j])}c()})}};Application.please._formatSearchString=function(a){return a.replace(/[^\w']/gi,"|").replace(/\|+/gi,"|").replace(/^\||\|$/gi,"").toLowerCase()};Application.please_findNodeIdFromUrl=function(b){var a=b.match(/\d+$/gi);return(a)?a[0]:null};Application.update={};Application.update.start=function(){this.stop();Application.update.state={list:[],total:0};Application.update._inventoryViews(function(){Application.update._inventoryNodes(function(){Application.update.state.total=Application.update.state.list.length;Application.update._nextItem()})})};Application.update.stop=function(){if(Application.update.state){delete Application.update.state}};Application.update._inventoryNodes=function(b){var a=function(d){for(var c=0;c<d.data.length;c++){Application.update.state.list.push({timestamp:d.data[c].changed,url:Const.DOMAIN+Const.URL_PAGE+d.data[c].nid})}delete d;b()};Application.trigger("update-progress",{status:Const.PROGRESS_MSG_INVENTORY_NODES});Application.please.xhr(Const.DOMAIN+Const.URL_NODE_TIMESTAMPS,{readCache:false,writeCache:false,success:function(c){if(!Application.supports.update.findExpired){a(c)}else{Application.trigger("update-progress",{status:Const.PROGRESS_MSG_BB_FIND_EXPIRED});window.plugins.update.findExpired(Application.please.generateKey(Const.DOMAIN+Const.URL_PAGE),c,function(d){a(d.message)})}}})};Application.update._inventoryViews=function(c){var a=function(d){Application.please.xhr(Const.DOMAIN+Const.URL_VIEW_GLOBAL,{readCache:false,writeCache:false,success:function(e){d(e.data)}})};var b=function(d){Application.please.xhr(Const.DOMAIN+Const.URL_VIEW_TIMESTAMPS,{readCache:false,writeCache:false,success:function(g){for(var f=0;f<g.data.length;f++){var e=(g.data[f].arg==="")?Const.DOMAIN+Const.URL_HOME:Const.DOMAIN+Const.URL_VIEW2+g.data[f].arg;Application.update.state.list.push({timestamp:g.data[f].timestamp,url:e})}delete g;d()}})};Application.trigger("update-progress",{status:Const.PROGRESS_MSG_INVENTORY_VIEWS});a(function(d){b(function(){Application.update.state.list.push({timestamp:d,url:Const.DOMAIN+Const.URL_VIEW_GLOBAL});c()})})};Application.update._nextItem=function(){if(!Application.update.state||Application.update.state.list.length<=0){Application.please.backupDatabase();return}var c=Application.update.state.list.shift();var a=Application.please.generateKey(c.url);Application.update._progress();var b=(c.url.indexOf(Const.URL_PAGE))?Const.PROGRESS_MSG_NODES:Const.PROGRESS_MSG_VIEWS;Application.trigger("update-progress",{status:b});Application.cache.find(a,{success:function(d){if(Application.update._isExpired(d.timestamp,c.timestamp)){Application.update._updateItem(c)}else{Application.update._nextItem()}},fail:function(){Application.update._updateItem(c)}})};Application.update._updateItem=function(a){Application.please.xhr(a.url,{readCache:false,writeCache:true,success:function(c){c.timestamp=a.timestamp;var b=Application.please.generateKey(a.url);Application.cache.write(b,c,Application.update._nextItem)}})};Application.update._isExpired=function(b,a){return(!b||!a||parseInt(b)<parseInt(a))};Application.update._progress=function(){if(!Application.update.state){return}var b=Application.update.state.list.length;if(b>0){var a=parseInt(Math.round((1-(b/Application.update.state.total))*100));Application.trigger("update-progress",{percentage:a})}else{Application.trigger("update-close")}};